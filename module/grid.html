
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grid</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/fretraj_logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Burst" href="burst.html" />
    <link rel="prev" title="FRET" href="fret.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/fretraj_logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to FRETraj
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/acv_calculation.html">
   Calculating ACVs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/fret_prediction.html">
   Making FRET predictions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/jupyter-notebook.html">
   <em>
    FRETraj
   </em>
   and Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/trajectories.html">
   Working with trajectories
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/photon_bursts.html">
   Generating photon bursts
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../background/accessible_volume.html">
   The accessible volume
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../background/contact_volume.html">
   Dye interactions with the biomolecule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../background/parameter_file.html">
   The parameter files
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Code
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cloud.html">
   Cloud
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fret.html">
   FRET
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Grid
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="burst.html">
   Burst
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="utilities.html">
   Utilities
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/module/grid.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/RNA-FRETools/fretraj"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/RNA-FRETools/fretraj/issues/new?title=Issue%20on%20page%20%2Fmodule/grid.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="grid">
<h1>Grid<a class="headerlink" href="#grid" title="Permalink to this headline">¶</a></h1>
<p>The <strong>grid</strong> submodule generates a ACV point cloud using Python-only functions. While naturally slower than the C++ version implemented in LabelLib it allows for rapid prototyping.</p>
<span class="target" id="module-fretraj.grid"></span><dl class="py class">
<dt id="fretraj.grid.Grid3D">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">fretraj.grid.</span></code><code class="sig-name descname"><span class="pre">Grid3D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attach_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dye_radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Class object holding a 3D grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>attach_xyz</strong> (<em>ndarray</em>) – one-dimensional array of x-,y-,z-coordinates of the attachment point
(corresponds to the center of the grid)</p></li>
<li><p><strong>linker_length</strong> (<em>float</em>) – length of the dye linker in Angstrom</p></li>
<li><p><strong>linker_width</strong> (<em>float</em>) – diameter of the dye linker in Angstrom</p></li>
<li><p><strong>dye_radii</strong> (<em>ndarray([3,1])</em>) – array of dye radii in Angstrom with shape [3,1]</p></li>
<li><p><strong>grid_spacing</strong> (<em>float</em>) – spacing between grid points (in A)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Attributes of the LabelLib class are:</dt><dd><ul class="simple">
<li><p>discStep : float  (the grid spacing)</p></li>
<li><p>originXYZ : numpy.array  (x-/y-/z-coordinate of the grid origin)</p></li>
<li><p>shape : numpy.array      (number of grid points in x-/y-/z-direction)</p></li>
<li><p>grid : numpy.array       (flattened list of grid point values)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="fretraj.grid.Grid3D._assignDensity">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_assignDensity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">das_xyzrm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distSq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outDistSq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D._assignDensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D._assignDensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop through the atom of the biomolecule and reassign those grid value which are within das_xyzrm[m, 3]
as they belong to the CV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p></li>
<li><p><strong>das_xyzrm</strong> (<em>ndarray</em>) – array of marked coordinates and padded vdW radii (n_atoms = number of atoms in mdtraj.Trajectory)</p></li>
<li><p><strong>neighbor_list</strong> (<em>list of 2-tuples of ndarray and float</em>) – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p></li>
<li><p><strong>ijk_atom</strong> (<em>array</em>) – ijk grid indices of the atoms of the biomolecule</p></li>
<li><p><strong>distSq</strong> (<em>float</em>) – square of the distance between the grid points to the attachment point</p></li>
<li><p><strong>outDistSq</strong> (<em>float</em>) – square of (halfcubelength + maxVdW_extraClash)</p></li>
<li><p><strong>grid_shape</strong> (<em>array</em>) – number of grid points in x,y and z coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D._assignRho">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_assignRho</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dye_radii_sorted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distSq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdistSq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D._assignRho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D._assignRho" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop through the atoms and radii and reassign the grid values with a number 0 &lt; rho &lt; 1.
0.00: grid point is not compatible with any of the three dye radii (clashes with VdW surface)
0.33: grid point is compatible with the smallest dye radius
0.66: grid point is compatible with the smallest two radii
1.00: grid point is compatible with all three dye radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p></li>
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>neighbor_list</strong> (<em>list of 2-tuples of ndarray and float</em>) – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p></li>
<li><p><strong>ijk_atom</strong> (<em>array</em>) – ijk grid indices of the atoms of the biomolecule</p></li>
<li><p><strong>dye_radii_sorted</strong> (<em>array</em>) – dye radii sorted in ascending order</p></li>
<li><p><strong>rhos</strong> (<em>array</em>) – array of grid values for assignment, for AV3 [0, 0.33, 0.66, 1] and for AV1 [0, 1]</p></li>
<li><p><strong>distSq</strong> (<em>float</em>) – square of the distance between the grid points to the attachment point</p></li>
<li><p><strong>outdistSq</strong> (<em>float</em>) – square of (halfcubelength + maxVdW_extraClash)</p></li>
<li><p><strong>grid_shape</strong> (<em>array</em>) – number of grid points in x,y and z coordinates</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D._carve_VdWextraClash">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_carve_VdWextraClash</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijk_atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraClash</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distSq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outDistSq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D._carve_VdWextraClash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D._carve_VdWextraClash" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop through the atoms and assign -1 to all grid values that are within the atoms VdW radius
plus an extraClash value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape of 2*adjL+1</p></li>
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>neighbor_list</strong> (<em>list of 2-tuples of ndarray and float</em>) – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p></li>
<li><p><strong>ijk_atom</strong> (<em>array</em>) – ijk grid indices of the atoms of the biomolecule</p></li>
<li><p><strong>extraClash</strong> (<em>float</em>) – clash radius added to the VdW radius</p></li>
<li><p><strong>distSq</strong> (<em>float</em>) – square of the distance between the grid points to the attachment point</p></li>
<li><p><strong>outDistSq</strong> (<em>float</em>) – square of (halfcubelength + maxVdW_extraClash)</p></li>
<li><p><strong>grid_shape</strong> (<em>array</em>) – number of grid points in x,y and z coordinates</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D._neighborIdx">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_neighborIdx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_spacing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D._neighborIdx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D._neighborIdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a list of neighboring indices to the origin (0,0,0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxR</strong> (<em>float</em>) – radius within which to search for neighbors</p></li>
<li><p><strong>grid_spacing</strong> (<em>float</em>) – spacing between grid points (in A)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list of 2-tuples of ndarray and float</em> – the tuples contain the ijk indices and the distance from the origin (0,0,0), e.g. [(1.0,array([-1,0,0]))]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The neighbor list is built from an origin set at (0,0,0). imaxR defines the number of indices
along one axis (i,j or k) to build the index cube.
For imaxR=3, first a cube of 7*7*7=343 indices is built (1).
This is reduced in a second step to 123 indices that have a distance &lt; imaxR from the origin (2).
Finally, they are reduced 74 essential neighbors by the distances in _dist_list (3).
(this last reduction speeds up the Dikstra algorithm due to the shorter neighbor list without loosing much
accuracy)</p>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D._xyz2idx">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">_xyz2idx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">originAdj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D._xyz2idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D._xyz2idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ijk grid indices for a set of xyz values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>ndarray</em>) – xyz coordinates</p></li>
<li><p><strong>originAdj</strong> (<em>ndarray</em>) – origin of the grid</p></li>
<li><p><strong>grid_spacing</strong> (<em>float</em>) – spacing between grid points (in A)</p></li>
<li><p><strong>decimals</strong> (<em>int</em>) – decimal to round to</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Round to n-decimal places (here: 4) before casting to integer</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.addWeights">
<code class="sig-name descname"><span class="pre">addWeights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">das_xyzrm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.addWeights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.addWeights" title="Permalink to this definition">¶</a></dt>
<dd><p>Reassign those grid values which are part of the contact volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>das_xyzrm</strong> (<em>ndarray</em>) – array of xyz coordinates, padded vdW radii and a marking (2.0)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.block_molecule">
<code class="sig-name descname"><span class="pre">block_molecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraClash</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.block_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.block_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Block the grid points which are within the VdW radius of any atom of the biomolecule plus an extra clash radius</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>extraClash</strong> (<em>float</em>) – clash radius added to the VdW radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape of 2*adjL+1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.dijkstra">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">dijkstra</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_ess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority_queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_ijk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.dijkstra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.dijkstra" title="Permalink to this definition">¶</a></dt>
<dd><p>Djikstra algorithm with a priority queue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p></li>
<li><p><strong>edges_ess</strong> (<em>nb.typed.List of 2-tuples of ndarray and float</em>) – list n essential neighbors from the origin (0,0,0)</p></li>
<li><p><strong>edges_src</strong> (<em>list of 2-tuples of ndarray and float</em>) – nb.typed.List of neighbors in the initialization round of the Dijkstra algorithm</p></li>
<li><p><strong>priority_queue</strong> (<em>list of 2-tuples of ndarray and float</em>) – list with distance and index of origin</p></li>
<li><p><strong>start_ijk</strong> (<em>array</em>) – ijk grid indices of the attachment site</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.dijkstra_init">
<code class="sig-name descname"><span class="pre">dijkstra_init</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxR_source</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.dijkstra_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.dijkstra_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the Dijkstra search algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxR</strong> (<em>float</em>) – radius within to search for neighbors</p></li>
<li><p><strong>maxRsource</strong> (<em>float</em>) – radius within to search for neighbors in the first round of the Dijkstra algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape of 2*adjL+1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.essential_neighbors">
<code class="sig-name descname"><span class="pre">essential_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.essential_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.essential_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the neighbor list to those indices with a distance from the origin featured in dist_list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idxs</strong> (<em>list of 2-tuples of ndarray and float</em>) – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p></li>
<li><p><strong>dist_list</strong> (<em>list</em>) – list of distances for neighbor search</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If dist_list=sqrt([1, 2, 3, 5, 6]) then the the neighbor list is reduced to 74 neighbors
which make up a spherical shape and are a good compromise between neighbor space and time efficiency
in the Dijkstra algorithm. The smaller this list the faster the Dijkstra algorithm will run
at the expense of the accuracy of the resulting accessible volume (i.e. its “sphericalness”)</p>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.excludeConcentricSpheres">
<code class="sig-name descname"><span class="pre">excludeConcentricSpheres</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dye_radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxRho</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.excludeConcentricSpheres"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.excludeConcentricSpheres" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude all grid points which are not compatible with any of the dye radii because of clashing with the VdW surface</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>dye_radii</strong> (<em>ndarray([3,1])</em>) – array of dye radii in Angstrom with shape [3,1]</p></li>
<li><p><strong>maxRho</strong> (<em>float</em>) – maximum grid value in the free volume</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.make_grid">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">make_grid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attach_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_spacing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.make_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.make_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a 3D grid around the attachment point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attach_xyz</strong> (<em>ndarray</em>) – one-dimensional array of x-,y-,z-coordinates of the attachment point
(corresponds to the center of the grid)</p></li>
<li><p><strong>linker_length</strong> (<em>float</em>) – length of the dye linker in Angstrom</p></li>
<li><p><strong>grid_spacing</strong> (<em>float</em>) – spacing between grid points (in A)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>tuple of ndarray</em> – 3-dimensional array of grid points with a shape of 2*ll_padRound+1, minimum of the grid, origin of the grid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.setAboveTreshold">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">setAboveTreshold</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.setAboveTreshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.setAboveTreshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Reassign grid values which are above a specified treshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p></li>
<li><p><strong>treshold</strong> (<em>float</em>) – grid values above this treshold are reassigned with new_value</p></li>
<li><p><strong>new_value</strong> (<em>float</em>) – new grid value to be assigned</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.sortedNeighborIdx">
<code class="sig-name descname"><span class="pre">sortedNeighborIdx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/grid.html#Grid3D.sortedNeighborIdx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.sortedNeighborIdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a neighbor list with a maximal extent given by maxR and sorted by increasing distance
from the origin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>maxR</strong> (<em>float</em>) – radius within to search for neighbors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list of 2-tuples of ndarray and float</em> – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./module"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="fret.html" title="previous page">FRET</a>
    <a class='right-next' id="next-link" href="burst.html" title="next page">Burst</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Fabio D. Steffen<br/>
        
            &copy; Copyright 2020-2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>