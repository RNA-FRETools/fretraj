

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Cloud</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'module/cloud';</script>
    <link rel="shortcut icon" href="../_static/fretraj_logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FRET" href="fret.html" />
    <link rel="prev" title="The parameter files" href="../background/parameter_file.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/fretraj_logo.png" class="logo__image only-light" alt=" - Home"/>
    <script>document.write(`<img src="../_static/fretraj_logo.png" class="logo__image only-dark" alt=" - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to FRETraj
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/acv_calculation.html">Calculating ACVs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/fret_prediction.html">Making FRET predictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/jupyter-notebook.html"><em>FRETraj</em> and Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/trajectories.html">Working with trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/photon_bursts.html">Generating photon bursts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../background/accessible_volume.html">The accessible volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/contact_volume.html">Dye interactions with the biomolecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/parameter_file.html">The parameter files</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="fret.html">FRET</a></li>
<li class="toctree-l1"><a class="reference internal" href="grid.html">Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="burst.html">Burst</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/RNA-FRETools/fretraj" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/RNA-FRETools/fretraj/issues/new?title=Issue%20on%20page%20%2Fmodule/cloud.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/module/cloud.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cloud</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cloud">
<h1>Cloud<a class="headerlink" href="#cloud" title="Permalink to this heading">#</a></h1>
<p>The <strong>cloud</strong> submodule includes functions to interact with AV/ACV clouds and interfaces with all other submodules.</p>
<span class="target" id="module-fretraj.cloud"></span><dl class="py class">
<dt class="sig sig-object py" id="fretraj.cloud.ACV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">ACV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_acv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_fraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud_xyzqt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_LabelLib</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#ACV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.ACV" title="Permalink to this definition">#</a></dt>
<dd><p>Reweighted accessible contact volume of a covalently linked fluorophore</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_acv</strong> (<em>LabelLib.Grid3D, optional=None</em>) – accessible volume with added weight labels for free and contact volume
(density label FV: 1.0, density label CV: 2.0); the two volumes are subsequently reweighted</p></li>
<li><p><strong>cv_thickness</strong> (<em>float, optional=0</em>) – width of the contact volume in Angstrom (default: 0, i.e. no CV is calculated)
<strong>Note:</strong> good first approx.: 2*min(dye_radii)</p></li>
<li><p><strong>cv_fraction</strong> (<em>float, optional=0</em>) – fraction of dyes that are within the contact volume
(e.g. as determined by fluorescence anisotropy)</p></li>
<li><p><strong>cloud_xyzq</strong> (<em>ndarray, optional=None</em>) – array of x-,y-,z-coordinates and corresponding weights
with a shape [n_gridpts(+), 4]</p></li>
<li><p><strong>use_LabelLib</strong> (<em>bool, optional=True</em>) – make use of LabelLib library to compute FRET values and distances</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.ACV._reweight_cv">
<span class="sig-name descname"><span class="pre">_reweight_cv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_thickness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_fraction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#ACV._reweight_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.ACV._reweight_cv" title="Permalink to this definition">#</a></dt>
<dd><p>Reweight the accessible volume based on contact and free volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv_thickness</strong> (<em>float</em>) – width of the contact volume in Angstrom (default: 0, i.e. no CV is calculated)</p></li>
<li><p><strong>cv_fraction</strong> (<em>float</em>) – relative fraction spent inside the contact volume (i.e. stacked to the surface)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em> – one-dimensional array of grid points of length n_gridpts</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>A good first approximation of the CV thickness is about two times the smallest dye radius</p></li>
<li><p>The CV fraction can be calculated from the residual fluorescence anisotropy</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.ACV._tag_volume">
<span class="sig-name descname"><span class="pre">_tag_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_1d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#ACV._tag_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.ACV._tag_volume" title="Permalink to this definition">#</a></dt>
<dd><p>Assign a tag to the grid values depending on their location in the cloud (1: free volume, 2: contact volume)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grid_1d</strong> (<em>ndarray</em>) – one-dimensional array of grid points length n_gridpts</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em> – one-dimensional array of length n_gridpts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.ACV._weight_factor">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_weight_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_1d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_fraction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#ACV._weight_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.ACV._weight_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the weight of contact volume grid points.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The weight factor corresponds to the factor by which the points of the contact volume
(CV, dye trapped on surface) are favored over those belonging the free volume (FV, free dye diffusion).
This accounts for the (experimentally) determined fraction of dyes populating the CV.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_1d</strong> (<em>ndarray</em>) – one-dimensional array of grid points of length n_gridpts</p></li>
<li><p><strong>cv_fraction</strong> (<em>float</em>) – fraction of dyes that are within the contact volume</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>float</em> – weight of each grid point that belongs to the contact volume</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fretraj.cloud.FRET">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">FRET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fret_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_DA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#FRET"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.FRET" title="Permalink to this definition">#</a></dt>
<dd><p>FRET class of distance and transfer efficiency for a pair of donor and acceptor ACVs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume1, volume2</strong> (<em>instances of the Volume class</em>)</p></li>
<li><p><strong>fret_pair</strong> (<em>str</em>) – Distance key specifying the donor acceptor pair</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – dye, linker and setup parameters for the accessible volume calculation</p></li>
<li><p><strong>R_DA</strong> (<em>ndarray</em>) – donor acceptor distance distribution and associate weights (optional)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ft</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ft</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume2</span><span class="p">,</span> <span class="n">use_LabelLib</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.FRET.from_volumes">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_volumes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_list2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fret_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_DA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#FRET.from_volumes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.FRET.from_volumes" title="Permalink to this definition">#</a></dt>
<dd><p>Alternative constructor for the FRET class by reading in a list of donor and acceptor volumes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume_list1, volume_list2</strong> (<em>array_like</em>) – lists of Volume instances</p></li>
<li><p><strong>fret_pair</strong> (<em>str</em>) – identifier for donor acceptor pair</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – dye, linker and setup parameters for the accessible volume calculation</p></li>
<li><p><strong>R_DA</strong> (<em>ndarray</em>) – donor acceptor distance distribution and associate weights (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.FRET.save_fret">
<span class="sig-name descname"><span class="pre">save_fret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#FRET.save_fret"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.FRET.save_fret" title="Permalink to this definition">#</a></dt>
<dd><p>Write the FRET calculation to a json file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename for FRET prediction</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">save_FRET</span><span class="p">(</span><span class="s1">&#39;parameters.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fretraj.cloud.FRET.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#fretraj.cloud.FRET.values" title="Permalink to this definition">#</a></dt>
<dd><p>Pandas Dataframe of FRET parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pandas.DataFrame</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fretraj.cloud.Trajectory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">Trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappasquare</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Trajectory" title="Permalink to this definition">#</a></dt>
<dd><p>Trajectory class of distances and transfer efficiencies from the FRET class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fret</strong> (<em>instance of the FRET class</em>)</p></li>
<li><p><strong>timestep</strong> (<em>int</em>) – time difference between two frames in picoseconds</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="fretraj.cloud.Trajectory.dataframe">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dataframe</span></span><a class="headerlink" href="#fretraj.cloud.Trajectory.dataframe" title="Permalink to this definition">#</a></dt>
<dd><p>Pandas Dataframe view of the Trajectory object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pandas.DataFrame</em> – Dataframe with distances and transfer efficiencies of the FRET trajectory</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Trajectory.save_traj">
<span class="sig-name descname"><span class="pre">save_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_kappa_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Trajectory.save_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Trajectory.save_traj" title="Permalink to this definition">#</a></dt>
<dd><p>Save the trajectory as a .csv file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for .csv trajectory</p></li>
<li><p><strong>format</strong> (<em>{‘csv’, ‘txt’}</em>)</p></li>
<li><p><strong>units</strong> (<em>{‘A’, ‘nm’}, optional=’A’</em>) – distance units (‘A’: Angstroms, ‘nm’: nanometers)</p></li>
<li><p><strong>header</strong> (<em>bool, default=True</em>) – include header in the output file</p></li>
<li><p><strong>R_kappa_only</strong> (<em>bool, default=False</em>) – include only time, R_DA and kappasquare columns in the output file (as <em>gmx dyecoupl</em>, Gromacs)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fretraj.cloud.Volume">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">Volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud_xyzqt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume" title="Permalink to this definition">#</a></dt>
<dd><p>Class object holding the accessible contact volume of a specific labeling position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>mdtraj.Trajectory</em>) – trajectory of atom coordinates loaded from a pdb, xtc or other file</p></li>
<li><p><strong>site</strong> (<em>str</em>) – reference identifier for the labeling position</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – dye, linker and setup parameters for the accessible volume calculation</p></li>
<li><p><strong>cloud_xyzqt</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates with corresponding weights and tags with a shape [n_gridpts(+), 5]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume._dye_acc_surf">
<span class="sig-name descname"><span class="pre">_dye_acc_surf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume._dye_acc_surf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume._dye_acc_surf" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate dye accessible surface by padding the vdW radius with the thickness of the contact volume</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em> – array with dimensions (5,n_atoms) of marked coordinates and padded vdW radii
(n_atoms = number of atoms in mdtraj.Trajectory)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume._weighted_quantile_1D">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_weighted_quantile_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr_1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume._weighted_quantile_1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume._weighted_quantile_1D" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the weighted quantile of a 1D-array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_1D</strong> (<em>ndarray</em>) – one-dimensional array</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – weight of each element of the array</p></li>
<li><p><strong>quantile</strong> (<em>float</em>) – quantile to compute (median=0.5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>quantile</strong> (<em>float</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.attach_xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">attach_xyz</span></span><a class="headerlink" href="#fretraj.cloud.Volume.attach_xyz" title="Permalink to this definition">#</a></dt>
<dd><p>Get coordinates of the dye attachment point</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em> – one-dimensional array of x-,y-,z-coordinates of the attachment point</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avobj</span><span class="o">.</span><span class="n">attach_xyz</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.calc_acv">
<span class="sig-name descname"><span class="pre">calc_acv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_LabelLib</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.calc_acv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.calc_acv" title="Permalink to this definition">#</a></dt>
<dd><p>Partition the accessible volume into a free and a contact volume</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>acv</strong> (<em>fretraj.cloud.ACV</em>)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>The attributes from the LabelLib.Grid3D object are:</dt><dd><ul class="simple">
<li><p>discStep : float  (the grid spacing)</p></li>
<li><p>originXYZ : list  (x-/y-/z-coordinate of the grid origin)</p></li>
<li><p>shape : list      (number of grid points in x-/y-/z-direction)</p></li>
<li><p>grid : list       (flattened list of grid point values)</p></li>
</ul>
</dd>
<dt>Additional attributes are:</dt><dd><ul class="simple">
<li><p>grid_3d : ndarray([shape])</p></li>
<li><p>n_gridpts : int</p></li>
<li><p>tag : ndarray([1,n_gridpts])</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#fretraj.cloud.Volume.calc_av" title="fretraj.cloud.Volume.calc_av"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_av</span></code></a></dt><dd><p>Calculate accessible volume</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<aside class="footnote brackets" id="id1" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Steffen, F. D., Sigel, R. K. O. &amp; Börner, R. “An atomistic view on carbocyanine photophysics in the realm of RNA”, <em>Phys. Chem. Chem. Phys.</em> <strong>18</strong>, 29045–29055 (2016).</p>
</aside>
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Dimura, M. et al. Quantitative FRET studies and integrative modeling unravel the structure and dynamics of biomolecular systems”, <em>Curr. Opin. Struct. Biol.</em> <strong>40</strong>, 163–185 (2016).</p>
</aside>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avobj</span><span class="o">.</span><span class="n">calc_acv</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.calc_av">
<span class="sig-name descname"><span class="pre">calc_av</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_LabelLib</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.calc_av"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.calc_av" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the dye accessible volume</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>LabelLib.Grid3D</em> – object containing a 3-dimensional array of grid points and additional attributes (see Notes)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>The attributes of the av LabelLib.Grid3D object are:</dt><dd><ul class="simple">
<li><p>discStep : float  (the grid spacing)</p></li>
<li><p>originXYZ : list  (x-/y-/z-coordinate of the grid origin)</p></li>
<li><p>shape : list      (number of grid points in x-/y-/z-direction)</p></li>
<li><p>grid : list       (flattened list of grid point values)</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#fretraj.cloud.Volume.calc_acv" title="fretraj.cloud.Volume.calc_acv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_acv</span></code></a></dt><dd><p>Calculate accessible contact volume</p>
</dd>
</dl>
</div>
<p class="rubric">References</p>
<aside class="footnote brackets" id="id3" role="note">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Kalinin, S. et al. “A toolkit and benchmark study for FRET-restrained high-precision structural modeling”, <em>Nat. Methods</em> <strong>9</strong>, 1218–1225 (2012).</p>
</aside>
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<p>Sindbert, S. et al. “Accurate distance determination of nucleic acids via Förster resonance energy transfer: implications of dye linker length and rigidity”, <em>J. Am. Chem. Soc.</em> <strong>133</strong>, 2463–2480 (2011).</p>
</aside>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avobj</span><span class="o">.</span><span class="n">calc_av</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.from_attachID">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_attachID</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachID</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.from_attachID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.from_attachID" title="Permalink to this definition">#</a></dt>
<dd><p>Alternative constructor for the Volume class by reading in one or multiple
attachment points using the same dye and grid parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>mdtraj.Trajectory</em>) – trajectory of atom coordinates loaded from a pdb, xtc or other file</p></li>
<li><p><strong>site</strong> (<em>str</em>) – reference identifier for the labeling position</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – dye, linker and setup parameters for the accessible volume calculation</p></li>
<li><p><strong>attachID</strong> (<em>int or list</em>) – list of attachment ids on the structure to be used for the ACV calculation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>list</em> – list of Volume instances</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">struct</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load_pdb</span><span class="p">(</span><span class="s1">&#39;data/2m23.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_global</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">labeling_params</span><span class="p">(</span><span class="s1">&#39;data/labels_global.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">from_attachID</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelsglobals</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">929</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.from_frames">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames_mdtraj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.from_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.from_frames" title="Permalink to this definition">#</a></dt>
<dd><p>Alternative constructor for the Volume class by reading in one or multiple
frames using the same dye and grid parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>mdtraj.Trajectory</em>) – trajectory of atom coordinates loaded from a pdb, xtc or other file</p></li>
<li><p><strong>site</strong> (<em>str</em>) – reference identifier for the labeling position</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – dye, linker and setup parameters for the accessible volume calculation</p></li>
<li><p><strong>frames_mdtraj</strong> (<em>int or list</em>) – list of frames on the trajectory to be used for the ACV calculation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>list</em> – list of Volume instances</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.grid2pts">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid2pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_xyz</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.grid2pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.grid2pts" title="Permalink to this definition">#</a></dt>
<dd><p>Convert 3D-grid with density values to xyz coordinates with a weight (q)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray([nx,ny,nz])</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p></li>
<li><p><strong>xyz_min</strong> (<em>ndarray</em>) – origin coordinates of the grid</p></li>
<li><p><strong>d_xyz</strong> (<em>ndarray</em>) – grid spacing in x-,y- and z-direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em> – array of x-,y-,z-coordinates with corresponding weights and tags with a shape [n_gridpts(+), 5]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grid_3d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_3d</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># FV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_3d</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># CV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ft</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">grid2pts</span><span class="p">(</span><span class="n">grid_3d</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">array([[ 0.5,  0.5,  0.5,  1.  1],</span>
<span class="go">       [ 0.5,  1. ,  0.5, 10.  1]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tag_3d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_3d</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># FV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid_3d</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># CV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ft</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">grid2pts</span><span class="p">(</span><span class="n">grid_3d</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">tag_3d</span><span class="p">)</span>
<span class="go">array([[ 0.5,  0.5,  0.5,  1.  1],</span>
<span class="go">       [ 0.5,  1. ,  0.5, 10.  2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.mean_pos">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cloud_xyzqt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.mean_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.mean_pos" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate mean dye position of the accessible contact volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cloud_xyzq</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and corresponding weights with a shape [n_gridpts(+), 4]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em> – mean position</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.mol_xyzr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mol_xyzr</span></span><a class="headerlink" href="#fretraj.cloud.Volume.mol_xyzr" title="Permalink to this definition">#</a></dt>
<dd><p>Get coordinates and vdW radii of all selected atoms in the structure</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em> – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avobj</span><span class="o">.</span><span class="n">mol_xyzr</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.reshape_grid">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reshape_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.reshape_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.reshape_grid" title="Permalink to this definition">#</a></dt>
<dd><p>Convert a 1D-grid to a 3D-Grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<em>array_like</em>) – one-dimensional grid array/list of length n_gridpts</p></li>
<li><p><strong>shape</strong> (<em>list</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em> – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ft</span><span class="o">.</span><span class="n">cloud</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">reshape_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[[1., 1., 1.],</span>
<span class="go">        [1., 1., 1.],</span>
<span class="go">        [1., 1., 1.]],</span>
<span class="go">         ...</span>
<span class="go">       [[1., 1., 1.],</span>
<span class="go">        [1., 1., 1.],</span>
<span class="go">        [1., 1., 1.]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.save_acv">
<span class="sig-name descname"><span class="pre">save_acv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdb'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.save_acv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.save_acv" title="Permalink to this definition">#</a></dt>
<dd><p>Write accessible contact volume to file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for ACV</p></li>
<li><p><strong>format</strong> (<em>{‘pdb’, ‘xyz’, ‘openDX’}</em>) – file format for ACV</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – key value pairs for .xyz files are {write_weights : bool, encode_element : bool}</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><cite>write_weights</cite> includes the weights of each point as an additional column in the .xyz file</p></li>
<li><p><cite>encode_element</cite> uses the element column (first col.) to encode the FV (=F) or CV (=C)</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">save_acv</span><span class="p">(</span><span class="s1">&#39;cloud.xyz&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">write_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fretraj.cloud.Volume.save_mp">
<span class="sig-name descname"><span class="pre">save_mp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plain'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#Volume.save_mp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.Volume.save_mp" title="Permalink to this definition">#</a></dt>
<dd><p>Write mean dye position to a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for the mean position</p></li>
<li><p><strong>format</strong> (<em>{‘plain’, ‘json’}</em>) – file format (plain .txt or .json)</p></li>
<li><p><strong>units</strong> (<em>{‘A’, ‘nm’}, optional=’A’</em>) – distance units (‘A’: Angstroms, ‘nm’: nanometers)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avobj</span><span class="o">.</span><span class="n">save_mp</span><span class="p">(</span><span class="s1">&#39;mp.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud._create_volume_topology">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">_create_volume_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#_create_volume_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud._create_volume_topology" title="Permalink to this definition">#</a></dt>
<dd><p>Create a topology for an accessible-contact volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_atoms</strong> (<em>int</em>) – number of points in the volume</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.acv_subsampling">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">acv_subsampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#acv_subsampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.acv_subsampling" title="Permalink to this definition">#</a></dt>
<dd><p>Subsample the ACV to obtain identical number of points over all volumes.
This allows to create mdtraj.Trajectory objects of the ACV which can be also save as .xtc or .xyz files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume_list</strong> (<em>array_like</em>) – list of Volume instances</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – be verbose about the number of subsamples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.check_labels">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">check_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#check_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.check_labels" title="Permalink to this definition">#</a></dt>
<dd><p>Check integrity of parameter dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>dict</em>) – position of labels, dye and grid parameters</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional=True</em>) – be verbose about missing parameter and their fall-back values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.create_acv_traj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">create_acv_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#create_acv_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.create_acv_traj" title="Permalink to this definition">#</a></dt>
<dd><p>Create a mdtraj.Trajectory object from a volume list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume_list</strong> (<em>array_like</em>) – list of Volume instances</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – be verbose about the number of subsamples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.labeling_params">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">labeling_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#labeling_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.labeling_params" title="Permalink to this definition">#</a></dt>
<dd><p>Parse the parameter file to get the configuration settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param_file</strong> (<em>str</em>) – json-formatted parameter filename</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>dict</em> – position of labels, dye and grid parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.load_acv_traj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">load_acv_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#load_acv_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.load_acv_traj" title="Permalink to this definition">#</a></dt>
<dd><p>Load an AV, FV and CV from .xyz or .xtc file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename of ACV trajectory</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multi model PDB files cannot be loaded as a mdtraj.Trajectory because they are on purpose not subsampled
and thus contain different number of points per volume</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.load_obj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">load_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#load_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.load_obj" title="Permalink to this definition">#</a></dt>
<dd><p>Load a serialized object from a binary file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename of pickle obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.pipeline_frames">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">pipeline_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donor_site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptor_site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fret_pair</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#pipeline_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.pipeline_frames" title="Permalink to this definition">#</a></dt>
<dd><p>Create a pipeline to compute multi-frame donor and acceptor ACVs and calculate a FRET trajectory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>mdtraj.Trajectory</em>) – trajectory of atom coordinates loaded from a pdb, xtc or other file</p></li>
<li><p><strong>donor_site</strong> (<em>str</em>) – reference identifier for the donor labeling position</p></li>
<li><p><strong>acceptor_site</strong> (<em>str</em>) – reference identifier for the acceptor labeling position</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – dye, linker and setup parameters for the accessible volume calculation</p></li>
<li><p><strong>frames_mdtraj</strong> (<em>list</em>) – list of frames on the trajectory to be used for the ACV calculation</p></li>
<li><p><strong>fret_pair</strong> (<em>str</em>) – Distance key specifying the donor acceptor pair</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Running a pipeline more memory-efficient than running Volume.from_frames()
because the ACVs are stored only until the FRET efficiency is calculated.
On the downside, no ACV trajectories(.xtc / .xyz) can be saved.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.printProgressBar">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">printProgressBar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Progress:'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'complete'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'█'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#printProgressBar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.printProgressBar" title="Permalink to this definition">#</a></dt>
<dd><p>Command line progress bar</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<em>int</em>) – current iteration</p></li>
<li><p><strong>total</strong> (<em>int</em>) – total number of iterations</p></li>
<li><p><strong>prefix</strong> (<em>str, optional=’Progress:’</em>) – string before progress bar</p></li>
<li><p><strong>suffix</strong> (<em>str, optional=’complete’</em>) – string after progress bar</p></li>
<li><p><strong>length</strong> (<em>int, optional=20</em>) – length of progress bar</p></li>
<li><p><strong>fill</strong> (<em>str, optional=’█’</em>) – fill character of progress bar</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">printProgressBar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="go">        doSomething</span>
<span class="go">        printProgressBar(i + 1, n)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.save_acv_traj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">save_acv_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#save_acv_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.save_acv_traj" title="Permalink to this definition">#</a></dt>
<dd><p>Save a trajectory of ACVs as a full multi model PDB or a subsampled .xyz or .xtc
(with identical number of points over all volumes)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for ACV trajectory</p></li>
<li><p><strong>volume_list</strong> (<em>array_like</em>) – list of Volume instances</p></li>
<li><p><strong>format</strong> (<em>str</em>) – file format of the ACV (for ‘pdb’ the full cloud is saved without subsampling;
for ‘xyz’ k points in the volumes are randomly picked, where k is the number
of points in the smallest volume)</p></li>
<li><p><strong>separate_CV</strong> (<em>bool</em>) – Save contact and free volume in separate files
(choose this if you want to retain the CV information)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.save_labels">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">save_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#save_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.save_labels" title="Permalink to this definition">#</a></dt>
<dd><p>Write the ACV parameters to a .json file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for label parameters</p></li>
<li><p><strong>labels</strong> (<em>dict</em>) – position of labels, dye and grid parameters</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">save_labels</span><span class="p">(</span><span class="s1">&#39;parameters.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.save_mp_traj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">save_mp_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#save_mp_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.save_mp_traj" title="Permalink to this definition">#</a></dt>
<dd><p>Save a trajectory of dye mean positions as an xyz file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for mean position trajectory</p></li>
<li><p><strong>volume_list</strong> (<em>array_like</em>) – list of Volume instances</p></li>
<li><p><strong>units</strong> (<em>{‘A’, ‘nm’}, optional=’A’</em>) – distance units (‘A’: Angstroms, ‘nm’: nanometers)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.save_obj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">save_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#save_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.save_obj" title="Permalink to this definition">#</a></dt>
<dd><p>Save a serialized object to a binary file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for pickle object</p></li>
<li><p><strong>obj</strong> (<em>serializable object</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fretraj.cloud.save_structure_traj">
<span class="sig-prename descclassname"><span class="pre">fretraj.cloud.</span></span><span class="sig-name descname"><span class="pre">save_structure_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdb'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fretraj/cloud.html#save_structure_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.cloud.save_structure_traj" title="Permalink to this definition">#</a></dt>
<dd><p>Save selected frames of a trajectory as multi-model PDB or XTC</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename for structure trajectory</p></li>
<li><p><strong>structure</strong> (<em>mdtraj.Trajectory</em>) – trajectory of atom coordinates loaded from a pdb, xtc or other file</p></li>
<li><p><strong>format</strong> (<em>{‘pdb’, ‘xtc’}</em>) – trajectory file format</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./module"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../background/parameter_file.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The parameter files</p>
      </div>
    </a>
    <a class="right-next"
       href="fret.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">FRET</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fabio D. Steffen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>